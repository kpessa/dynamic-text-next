# Dynamic Text Next Fullstack Architecture Document

## Table of Contents

- [Dynamic Text Next Fullstack Architecture Document](#table-of-contents)
  - [Introduction](./introduction.md)
    - [Starter Template or Existing Project](./introduction.md#starter-template-or-existing-project)
    - [Change Log](./introduction.md#change-log)
  - [High Level Architecture](./high-level-architecture.md)
    - [Technical Summary](./high-level-architecture.md#technical-summary)
    - [Platform and Infrastructure Choice](./high-level-architecture.md#platform-and-infrastructure-choice)
    - [Repository Structure](./high-level-architecture.md#repository-structure)
    - [High Level Architecture Diagram](./high-level-architecture.md#high-level-architecture-diagram)
    - [Architectural Patterns](./high-level-architecture.md#architectural-patterns)
  - [Tech Stack](./tech-stack.md)
    - [Technology Stack Table](./tech-stack.md#technology-stack-table)
  - [Data Models](./data-models.md)
    - [Core Types (Aligned with Parent Project)](./data-models.md#core-types-aligned-with-parent-project)
      - [Section and Test Types](./data-models.md#section-and-test-types)
      - [TPN Types](./data-models.md#tpn-types)
      - [Workspace Types](./data-models.md#workspace-types)
    - [User](./data-models.md#user)
      - [TypeScript Interface:](./data-models.md#typescript-interface)
      - [Relationships:](./data-models.md#relationships)
    - [DynamicTextTemplate](./data-models.md#dynamictexttemplate)
      - [TypeScript Interface:](./data-models.md#typescript-interface)
      - [Relationships:](./data-models.md#relationships)
    - [TPNSimulation](./data-models.md#tpnsimulation)
      - [TypeScript Interface:](./data-models.md#typescript-interface)
      - [Relationships:](./data-models.md#relationships)
    - [TestScenario](./data-models.md#testscenario)
      - [TypeScript Interface:](./data-models.md#typescript-interface)
      - [Relationships:](./data-models.md#relationships)
    - [GeneratedDocument](./data-models.md#generateddocument)
      - [TypeScript Interface:](./data-models.md#typescript-interface)
      - [Relationships:](./data-models.md#relationships)
    - [ConfigSchema](./data-models.md#configschema)
      - [TypeScript Interface:](./data-models.md#typescript-interface)
      - [Relationships:](./data-models.md#relationships)
  - [API Specification](./api-specification.md)
    - [REST API Specification](./api-specification.md#rest-api-specification)
  - [Components](./components.md)
    - [Frontend Components](./components.md#frontend-components)
      - [UI Component Library](./components.md#ui-component-library)
      - [State Management Layer](./components.md#state-management-layer)
      - [TPN Calculator Engine](./components.md#tpn-calculator-engine)
      - [Dynamic Text Processor](./components.md#dynamic-text-processor)
      - [Secure Code Executor](./components.md#secure-code-executor)
      - [Real-time Sync Manager](./components.md#real-time-sync-manager)
    - [Backend Components](./components.md#backend-components)
      - [API Gateway](./components.md#api-gateway)
      - [Business Logic Service](./components.md#business-logic-service)
      - [Repository Layer](./components.md#repository-layer)
      - [AI Integration Service](./components.md#ai-integration-service)
    - [Shared Components](./components.md#shared-components)
      - [Type Definitions Package](./components.md#type-definitions-package)
      - [Security Module](./components.md#security-module)
    - [Component Interaction Diagram](./components.md#component-interaction-diagram)
  - [External APIs](./external-apis.md)
    - [Firebase Services API](./external-apis.md#firebase-services-api)
    - [Google Gemini AI API](./external-apis.md#google-gemini-ai-api)
    - [Vercel Analytics API](./external-apis.md#vercel-analytics-api)
  - [Core Workflows](./core-workflows.md)
    - [User Authentication Flow](./core-workflows.md#user-authentication-flow)
    - [Dynamic Code Execution Flow (Critical from Parent)](./core-workflows.md#dynamic-code-execution-flow-critical-from-parent)
    - [TPN Simulation Calculation Flow](./core-workflows.md#tpn-simulation-calculation-flow)
    - [Test Generation Flow](./core-workflows.md#test-generation-flow)
    - [Section Content Management Flow](./core-workflows.md#section-content-management-flow)
    - [Ingredient Sharing Workflow](./core-workflows.md#ingredient-sharing-workflow)
  - [Database Schema](./database-schema.md)
    - [Firestore Collections Structure](./database-schema.md#firestore-collections-structure)
    - [Firestore Security Rules](./database-schema.md#firestore-security-rules)
  - [Frontend Architecture](./frontend-architecture.md)
    - [Component Architecture](./frontend-architecture.md#component-architecture)
      - [Component Organization (FSD + Atomic)](./frontend-architecture.md#component-organization-fsd-atomic)
      - [Component Size Rules (from Parent Project)](./frontend-architecture.md#component-size-rules-from-parent-project)
    - [State Management Architecture](./frontend-architecture.md#state-management-architecture)
      - [Redux Store Structure](./frontend-architecture.md#redux-store-structure)
    - [Routing Architecture](./frontend-architecture.md#routing-architecture)
      - [Next.js App Router Structure](./frontend-architecture.md#nextjs-app-router-structure)
    - [Code Execution Architecture (Critical from Parent)](./frontend-architecture.md#code-execution-architecture-critical-from-parent)
      - [Secure Sandbox Implementation](./frontend-architecture.md#secure-sandbox-implementation)
  - [Backend Architecture](./backend-architecture.md)
    - [API Route Organization](./backend-architecture.md#api-route-organization)
    - [Middleware Architecture](./backend-architecture.md#middleware-architecture)
  - [Security Architecture](./security-architecture.md)
    - [Input Sanitization (from Parent Project)](./security-architecture.md#input-sanitization-from-parent-project)
    - [Authentication Flow](./security-architecture.md#authentication-flow)
  - [Performance Optimization](./performance-optimization.md)
    - [Bundle Size Management (Target: <1MB)](./performance-optimization.md#bundle-size-management-target-1mb)
    - [Performance Targets (from Parent)](./performance-optimization.md#performance-targets-from-parent)
    - [Optimization Strategies](./performance-optimization.md#optimization-strategies)
  - [Testing Strategy](./testing-strategy.md)
    - [Test Pyramid (from Parent Project)](./testing-strategy.md#test-pyramid-from-parent-project)
    - [Testing Organization by FSD Layer](./testing-strategy.md#testing-organization-by-fsd-layer)
    - [Test Patterns](./testing-strategy.md#test-patterns)
      - [Unit Test Example](./testing-strategy.md#unit-test-example)
      - [Integration Test Example](./testing-strategy.md#integration-test-example)
      - [E2E Test Example (Playwright)](./testing-strategy.md#e2e-test-example-playwright)
  - [Deployment Architecture](./deployment-architecture.md)
    - [Infrastructure](./deployment-architecture.md#infrastructure)
    - [CI/CD Pipeline](./deployment-architecture.md#cicd-pipeline)
    - [Environment Configuration](./deployment-architecture.md#environment-configuration)
  - [Monitoring and Observability](./monitoring-and-observability.md)
    - [Monitoring Stack](./monitoring-and-observability.md#monitoring-stack)
    - [Key Metrics to Track](./monitoring-and-observability.md#key-metrics-to-track)
  - [Coding Standards](./coding-standards.md)
    - [Critical Rules (from Parent Project + Next.js)](./coding-standards.md#critical-rules-from-parent-project-nextjs)
    - [Naming Conventions](./coding-standards.md#naming-conventions)
  - [Migration Considerations](./migration-considerations.md)
    - [From Svelte to Next.js](./migration-considerations.md#from-svelte-to-nextjs)
    - [Key Differences to Note](./migration-considerations.md#key-differences-to-note)
  - [Future Enhancements](./future-enhancements.md)
    - [Planned Features (from Parent Project)](./future-enhancements.md#planned-features-from-parent-project)
    - [Technical Debt to Address](./future-enhancements.md#technical-debt-to-address)
  - [Summary](./summary.md)
